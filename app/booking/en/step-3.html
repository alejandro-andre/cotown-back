<!DOCTYPE html>
<html lang="es">

<head>
  [% include 'en/includes/head.html' %]
</head>

<body>
  <div class="tabs-container">

    [% include 'en/includes/header.html' %]

    <div class="main-booking">
      <div class="main-contain">
        <div class="panel-container pure-g">

          <div class="left tab3 pure-u-1 pure-u-lg-2-3">

            <h2>Book your place</h2>

            [% if data.logged %]

            <form id="book-form" action="/booking/4" method="post">
              <fieldset>
                <div class="logged-booking pure-g">

                  <h3 class="pure-u-1">Hello [[data.customer.Name]]!</h3>
                  <p class="pure-u-1">Fill in the following information to formalize your reservation.</p>

                  <div class="pure-u-1">
                    <div class="campo">
                      <label class="label">Reason for stay</label>
                      <select name="Reason_id" required>
                        <option value="">Select a reason</option>
                        [% for c in data.reasons %]
                        <option value="[[c.id]]">[[c.Name]]</option>
                        [% endfor %]
                       </select>
                    </div>
                  </div>

                  <input type="hidden" name="book_action" value="book">

                  <section class="next">
                    <button type="submit" class="btn-secondary">Confirm and book</button>
                  </section>

                </div>

              </fieldset>
            </form>

            <form id="logout-form" action="/booking/4" method="post" style="margin-top: -40px;">
              <fieldset>
                <div class="pure-g">
                  <section class="next">
                    <input type="hidden" name="book_action" value="logout">
                    <button type="submit" class="btn-primary">I'm not [[data.customer.Name]]</button>
                  </section>
                </div>
              </fieldset>
            </form>

            [% else %]

            <form id="login-form" action="/booking/4" method="post">
              <fieldset>
                <div class="login pure-g">

                  <h3 class="pure-u-1">Log in</h3>
                  <p class="pure-u-1">Use your credentials to access.</p>

                  <div class="pure-u-1">
                      <div class="campo">
                      <label class="label">Email</label>
                      <input class="input" type="email" name="book_user"
                             required placeholder="Tu email">
                    </div>
                  </div>
                  <div class="pure-u-1">
                    <div class="campo psw">
                      <label class="label">Password</label>
                      <input class="input" type="password" name="book_password"
                             required placeholder="Tu contraseña">
                    </div>
                  </div>

                  [% if data.error_login %]
                  <div class="pure-u-1 error-message"><p>[[data.error_login[data.lang]]]</p></div>
                  [% endif %]

                  <p class="advise">
                    If you have forgotten your password, you can reset it using our
                    <a href="https://core.cotown.com/auth/realms/airflows/login-actions/reset-credentials?client_id=airflows-private">password recovery form.</a>.
                  </p>

                  <input type="hidden" name="book_action" value="login">

                  <section class="next">
                    <button type="submit" class="btn-secondary">Log in</button>
                  </section>

                </div>
              </fieldset>
            </form>

            <form id="register-form" action="/booking/4" method="post">
              <fieldset>
                <div class="registry pure-g">

                  <h3 class="pure-u-1 record">Or sign up</h3>
                  <p class="pure-u-1">We will need your details to finalize the booking.</p>

                  <div class="pure-u-1">
                    <div class="campo">
                      <label class="label">Full name</label>
                      <input class="input" type="name" name="Name" value="[[data.customer.Name]]"
                             required placeholder="Tú nombre y apellidos">
                    </div>
                  </div>

                  <div class="pure-u-1">
                    <div class="campo">
                      <label class="label">Email</label>
                      <input class="input" type="email" name="Email" value="[[data.customer.Email]]"
                             required placeholder="Tu email">
                    </div>
                  </div>

                  <div class="pure-u-1-3">
                    <div class="campo">
                      <label class="label">Phone prefix</label>
                      <select name="Prefix" required>
                        <option value="">Select phone prefix</option>
                        [% for c in data.countries %]
                        [% if c.Prefix != null %]
                        <option value="[[c.Prefix]]"[% if c.Prefix==data.customer.Prefix %] selected[% endif %]>[[c.Name]] ([[c.Prefix]])</option>
                        [% endif %]
                        [% endfor %]
                      </select>
                    </div>
                  </div>

                  <div class="pure-u-2-3">
                    <div class="campo">
                      <label class="label">Phone number</label>
                      <input class="input" type="name" name="Phone"
                             required value="[[data.customer.Phone]]" placeholder="Your phone number">
                    </div>
                  </div>

                  <div class="pure-u-1 pure-u-lg-1-3">
                    <div class="campo">
                      <div class="dates">
                        <label class="label">Birth date</label>
                        <input type="date" name="Birth_date"
                               required value="[[data.customer.Birth_date]]" placeholder="Date dd/mm/aaaa"/>
                      </div>
                    </div>
                  </div>

                  <div class="pure-u-1 pure-u-lg-1-3">
                    <div class="campo">
                      <label class="label">Nationality</label>
                      <select name="Nationality_id" required>
                        <option value="">Select country</option>
                        [% for c in data.countries %]
                        <option value="[[c.id]]"[% if c.id==data.customer.Nationality_id %] selected[% endif %]>[[c.Name]]</option>
                        [% endfor %]
                      </select>
                    </div>
                  </div>

                  <div class="pure-u-1 pure-u-lg-1-3">
                    <div class="campo">
                      <label class="label">Gender</label>
                      <select name="Gender_id" required>
                        <option value="">Select gender</option>
                        [% for c in data.genders %]
                        <option item="[[data.customer.Gender_id]]" value="[[c.id]]"[% if c.id==data.customer.Gender_id %] selected[% endif %]>[[c.Name]]</option>
                        [% endfor %]
                      </select>
                    </div>
                  </div>

                  [% if data.error_register %]
                  <div class="pure-u-1 error-message"><p>[[data.error_register[data.lang]]]</p></div>
                  [% endif %]

                  <input type="hidden" name="book_action" value="register">

                  <section class="next">
                    <button type="submit" class="btn-secondary">Sign up</button>
                  </section>

                </div>
                [% endif %]

              </fieldset>
            </form>

          </div>

          <div class="right tab3 pure-u-1 pure-u-lg-1-3">
            <div class="summary">
              <h3>Booking summary</h3>
              <p>Location</p>
              <div class="summary-edit">
                <h4>[[data.city.Name]]</h4>
                <!--
                <button class="btn-text">
                  <em class="icon-write"></em>
                  <p>Editar</p>
                </button>
                -->
              </div>

              <div class="dates">
                <div class="in">
                  <p>CHECK IN</p>
                  <h4>[[data.date_from]]</h4>
                </div>
                <div class="out">
                  <p>CHECK OUT</p>
                  <h4>[[data.date_to]]</h4>
                </div>
              </div>

              <div class="type-summary">
                <h4>[[data.summary.Place_type_name]]</h4>
                <!--[[data.summary.Flat_type_name]]--> 
                <p>[[data.summary.Building_name]]</p>                                     
              </div>

              <div class="breakdown">
                <h4>Prices</h4>
                <div class="prices">
                  <p>Booking fee</p>
                  <p>[[data.summary.Booking_fee]]€</p>
                </div>
                <div class="prices">
                  <p>Deposit</p>
                  <p>
                    [% if data.summary.Deposit < data.summary.Rent + data.summary.Services %]
                    [[data.summary.Rent + data.summary.Services]]
                    [% else %]
                    [[data.summary.Deposit]]
                    [% endif %]
                  €</p>
                </div>
                [% if data.summary.Final_cleaning %]
                <div class="prices">
                  <p>Final cleaning</p>
                  <p>[[data.summary.Final_cleaning]]€</p>
                </div>
                [% endif %]
                <div class="total">
                  <p>Total single payment</p>
                  <p>
                    [% if data.summary.Deposit < data.summary.Rent + data.summary.Services %]
                    [[data.summary.Booking_fee + data.summary.Rent + data.summary.Services]] €
                    [% else %]
                    [[data.summary.Booking_fee + data.summary.Deposit]] €
                    [% endif %]
                  </p>
                </div>
              </div>

              <div class="renta">
                <h3>Average monthly rent</h3>
                <h3>[[data.summary.Rent + data.summary.Services]]€ *</h3>
              </div>

              <p class="advise">* Water, gas, and electricity supplies included in the monthly amount up to [[data.summary.Limit]]€/mo.</p>

            </div>
          </div>

        </div>
      </div>
    </div>

  </div>

</body>

[% include 'en/includes/footer.html' %]

</html>