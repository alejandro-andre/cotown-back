<!DOCTYPE html>
<html lang="es">

<head>
  [% include 'en/includes/head.html' %]
</head>

<body>
  <div class="tabs-container">

    [% include 'en/includes/header.html' %]

    <div class="main-booking">
      <div id="section3" class="main-contain">
        <div class="panel-container pure-g">               

          <div class="left tab3 pure-u-1 pure-u-lg-3-5">

            <h2>Reserva tu habitación</h2> 

            [% if data.logged %]
            <form id="book-form" action="/booking/4" method="post">
              <fieldset>
                <div class="logged-booking pure-g">

                  <h3 class="pure-u-1">Reservar</h3>
                  <p class="pure-u-1">Comprueba tus datos si ya estás registrado.</p>

                  <div class="pure-u-1">
                    <div class="campo">
                      <label class="label">Nombre y apellidos</label>                 
                      <input class="input" type="name" id="Name" name="Name" required value="[[data.customer.Name]]" placeholder="Tú nombre y apellidos">
                    </div>
                  </div>
                  <div class="pure-u-1">
                    <div class="campo">
                      <label class="label">Email</label>                 
                      <input class="input" type="email" id="Email" name="Email" required  value="[[data.customer.Email]]"placeholder="Tu email">
                    </div>
                  </div>
                  <div class="pure-u-1-5">
                    <div class="campo">
                      <label class="label">Código</label>         
                      <select id="Prefix" name="Prefix" required>
                        <option value="">Selecciona prefijo</option>
                        [% for c in data.countries %]
                        [% if c.Prefix != null %]
                        <option value="[[c.Prefix]]">[[c.Name]] ([[c.Prefix]])</option>
                        [% endif %]
                        [% endfor %]
                      </select>
                    </div>                 
                  </div>
                  <div class="pure-u-4-5">
                    <div class="campo">
                      <label class="label">Número de teléfono</label>                 
                      <input class="input" type="name" id="Phones" name="Phones" required value="[[data.customer.Phones]]" placeholder="Tu nº de teléfono">
                    </div>
                  </div>
                  <div class="pure-u-1 pure-u-lg-1-2">
                    <div class="campo">
                      <div class="dates">
                        <label class="label">Fecha de nacimiento</label> 
                        <input type="date" id="Birth_date" name="Birth_date" required value="[[data.customer.Birth_date]]" placeholder="Fecha dd/mm/aaaa"/>
                      </div>
                    </div>
                  </div>
                  <div class="pure-u-1 pure-u-lg-1-2">
                    <div class="campo">
                      <label class="label">Nacionalidad</label>         
                      <select id="Nationality_id" name="Nationality_id" required value="[[data.customer.Nationality_id]]">
                        <option value="">Selecciona país</option>
                        [% for c in data.countries %]
                        <option value="[[c.id]]">[[c.Name]]</option>
                        [% endfor %]
                      </select>
                    </div>
                  </div>
                  <div class="pure-u-1 pure-u-lg-1-2">
                    <div class="campo">
                      <label class="label">Género</label>         
                      <select id="Gender_id" name="Gender_id" required value="[[data.customer.Gender_id]]">
                        <option value="">Selecciona género</option>
                        [% for c in data.genders %]
                        <option value="[[c.id]]">[[c.Name]]</option>
                        [% endfor %]
                       </select>
                    </div>
                  </div>
                  <div class="pure-u-1 pure-u-lg-1-2">
                    <div class="campo">
                      <label class="label">Motivo de la estancia</label>         
                      <select id="Reason_id" name="Reason_id" required>
                        <option value="">Selecciona motivo</option>
                        [% for c in data.reasons %]
                        <option value="[[c.id]]">[[c.Name]]</option>
                        [% endfor %]
                       </select>
                    </div>
                  </div>
                  <section class="next">
                    <input type="hidden" name="book_action" value="book">
                    <button class="btn-secondary" onclick="go_book();">Confirmar y reservar</button>
                  </section>
                </div> 
              </fieldset>
            </form>

            [% else %]

            <form id="login-form" action="/booking/4" method="post">
              <fieldset>
                <div class="login pure-g">

                  <h3 class="pure-u-1">Iniciar sesión</h3>
                  <p class="pure-u-1">Utiliza tus credenciales para acceder a tu área privada.</p>

                  <div class="pure-u-1">
                      <div class="campo">
                      <label class="label">Email</label>                 
                      <input class="input" type="email" id="book_user" name="book_user" required placeholder="Tu email">
                    </div>
                  </div>
                  <div class="pure-u-1">
                    <div class="campo psw">
                      <label class="label">Contraseña</label>                 
                      <input class="input" type="password" id="book_password" name="book_password" required placeholder="Tu contraseña">
                    </div>
                  </div>

                  [% if data.error %]
                  <div class="error-message"><p>[[data.error]]</p></div>
                  [% endif %]
                  
                  <p class="advise">Si ha olvidado su contraseña o dirección de correo electrónico, puedes restablecerlas utilizando nuestro formulario de recuperación de contraseña.</p>
 
                  <section class="next">
                    <input type="hidden" name="book_action" value="login">
                    <button class="btn-secondary" onclick="go_login();">Iniciar sesión</button>
                  </section>

                </div>
              </fieldset>
            </form>

            <form id="register-form" action="/booking/4" method="post">
              <fieldset>
                <div class="registry pure-g">

                  <h3 class="pure-u-1 record">Registro</h3>
                  <p class="pure-u-1">En caso que no te hayas registrado todavía, necesitaremos los siguientes datos de contacto para formalizar tu reserva.</p>

                  <div class="pure-u-1">
                    <div class="campo">
                      <label class="label">Nombre y apellidos</label>                 
                      <input class="input" type="name" id="Name" name="Name" required placeholder="Tú nombre y apellidos">
                    </div>
                  </div>
                  <div class="pure-u-1">
                    <div class="campo">
                      <label class="label">Email</label>                 
                      <input class="input" type="email" id="Email" name="Email" required placeholder="Tu email">
                    </div>
                  </div>
                  <div class="pure-u-2-5">
                    <div class="campo">
                      <label class="label">Código</label>         
                      <select id="Prefix" name="Prefix" required>
                        <option value="">Selecciona prefijo</option>
                        [% for c in data.countries %]
                        [% if c.Prefix != null %]
                        <option value="[[c.Prefix]]">[[c.Name]] ([[c.Prefix]])</option>
                        [% endif %]
                        [% endfor %]
                      </select>
                    </div>                 
                  </div>
                  <div class="pure-u-3-5">
                    <div class="campo">
                      <label class="label">Número de teléfono</label>                 
                      <input class="input" type="name" id="Phone" name="Phone" required placeholder="Tu nº de teléfono">
                    </div>
                  </div>
                  <div class="pure-u-1 pure-u-lg-1-2">
                    <div class="campo">
                      <div class="dates">
                        <label class="label">Fecha de nacimiento</label> 
                        <input type="date" id="Birth_date" name="Birth_date" required placeholder="Fecha dd/mm/aaaa"/>
                      </div>
                    </div>
                  </div>
                  <div class="pure-u-1 pure-u-lg-1-2">
                    <div class="campo">
                      <label class="label">Nacionalidad</label>         
                      <select id="Nationality_id" name="Nationality_id" required>
                        <option value="">Selecciona país</option>
                        [% for c in data.countries %]
                        <option value="[[c.id]]">[[c.Name]]</option>
                        [% endfor %]
                     </select>
                    </div>
                  </div>
                  <div class="pure-u-1 pure-u-lg-1-2">
                    <div class="campo">
                      <label class="label">Género</label>         
                      <select id="Gender_id" name="Gender_id" required>
                        <option value="">Selecciona género</option>
                        [% for c in data.genders %]
                        <option value="[[c.id]]">[[c.Name]]</option>
                        [% endfor %]
                      </select>
                    </div>
                  </div>
                  <div class="pure-u-1 pure-u-lg-1-2">
                    <div class="campo">
                      <label class="label">Motivo de la estancia</label>         
                      <select id="Reason_id" name="Reason_id" required>
                        <option value="">Selecciona motivo</option>
                        [% for c in data.reasons %]
                        <option value="[[c.id]]">[[c.Name]]</option>
                        [% endfor %]
                      </select>
                    </div>
                  </div>
                  <section class="next">
                    <input type="hidden" name="book_action" value="register">
                    <button class="btn-secondary" onclick="go_register();">Registrarse</button>
                  </section>
                </div>
                [% endif %]
              </fieldset>
            </form>
          </div>

          <div class="right tab3 pure-u-1 pure-u-lg-2-5">
            <div class="resume">
              <h3>Resumen de reserva</h3>
              <p>Ubicación</p>
              <div class="resume-edit">
                <h4>[[data.city.Name]]</h4>
                <!--
                <button class="btn-text">
                  <em class="icon-write"></em>
                  <p>Editar</p>
                </button>
                -->
              </div>

              <div class="dates">
                <div class="in">
                  <p>ENTRADA</p>
                  <h4>[[data.date_from]]</h4>
                </div>
                <div class="out">
                  <p>SALIDA</p>
                  <h4>[[data.date_to]]</h4>
                </div>               
              </div>

              <div class="type-resume">
                <h4>[[data.summary.Place_type_name]]</h4>
                <p>[[data.summary.Building_name]]</p>                                                         
              </div>

              <div class="breakdown">
                <h4>Desglose del precio</h4>
                <div class="prices">
                  <p>Booking fee</p>
                  <p>[[data.summary.Booking_fee]]€</p>
                </div>             
                <div class="prices">
                  <p>Garantía</p>
                  <p>
                    [% if data.summary.Deposit < data.summary.Rent + data.summary.Services %]
                    [[data.summary.Rent + data.summary.Services]]
                    [% else %]
                    [[data.summary.Deposit]]
                    [% endif %]
                  €</p>
                </div>
                [% if data.summary.Final_cleaning %]
                <div class="prices">
                  <p>Limpieza final</p>
                  <p>[[data.summary.Final_cleaning]]€</p>
                </div>             
                [% endif %]
                <div class="total">
                  <p>Total pago único</p>
                  <p>
                    [% if data.summary.Deposit < data.summary.Rent + data.summary.Services %]
                    [[data.summary.Booking_fee + data.summary.Rent + data.summary.Services]]
                    [% else %]
                    [[data.summary.Booking_fee + data.summary.Deposit]]
                    [% endif %]
                  </p>
                </div>           
              </div>

              <div class="renta">
                <h3>Renta media mensual</h3>
                <h3>[[data.summary.Rent + data.summary.Services]]€ *</h3>
              </div>

              <p class="advise">* Suministros de agua, gas y luz incluidos en el importe mensual hasta [[data.summary.Limit]]€/mes.</p>

            </div>
          </div>

        </div>
      </div>     
    </div>

  </div>
</body>

<script>
function go_login() {
   document.getElementById("login_form").submit();
}
function go_register() {
   document.getElementById("register_form").submit();
}
function go_book() {
   document.getElementById("book_form").submit();
}
</script>
</html>
